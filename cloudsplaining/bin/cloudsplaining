#! /usr/bin/env python
"""
    Cloudsplaining identifies violations of least privilege in AWS IAM policies. It can scan all the policies in your AWS account or it can scan a single policy file.
"""
__version__ = "0.0.1"
import click
from cloudsplaining import command


@click.group()
@click.version_option(version=__version__)
def cloudsplaining():
    """
    cloudsplaining identifies violations of least privilege in AWS IAM policies
    """


cloudsplaining.add_command(command.create_exclusions_template.create_exclusions_template)
cloudsplaining.add_command(command.expand_policy.expand_policy)
cloudsplaining.add_command(command.scan.scan)
cloudsplaining.add_command(command.scan_policy_file.scan_policy_file)
cloudsplaining.add_command(command.download_authorization_details.download_authorization_details)

if __name__ == "__main__":
    cloudsplaining()
