#! /usr/bin/env python
# Copyright (c) 2020, salesforce.com, inc.
# All rights reserved.
# Licensed under the BSD 3-Clause license.
# For full license text, see the LICENSE file in the repo root
# or https://opensource.org/licenses/BSD-3-Clause
"""
    Cloudsplaining identifies violations of least privilege in AWS IAM policies. It can scan all the policies in your AWS account or it can scan a single policy file.
"""
__version__ = "0.0.1"
import click
from cloudsplaining import command


@click.group()
@click.version_option(version=__version__)
def cloudsplaining():
    """
    cloudsplaining identifies violations of least privilege in AWS IAM policies
    """


cloudsplaining.add_command(command.create_exclusions_file.create_exclusions_file)
cloudsplaining.add_command(command.expand_policy.expand_policy)
cloudsplaining.add_command(command.scan.scan)
cloudsplaining.add_command(command.scan_policy_file.scan_policy_file)
cloudsplaining.add_command(command.download.download)

if __name__ == "__main__":
    cloudsplaining()
